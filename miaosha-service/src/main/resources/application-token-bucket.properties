# 分布式令牌桶限流配置
miaosha.rate-limit.token-bucket:
  # 默认配置
  default-capacity: 100
  default-rate: 10.0
  default-warmup-tokens: 50
  enable-warmup: true
  warmup-delay: 5000
  
  # 用户级别限流配置
  user-rule:
    capacity: 20
    rate: 2.0
    warmup-tokens: 10
  
  # 全局级别限流配置
  global-rule:
    capacity: 1000
    rate: 100.0
    warmup-tokens: 500
  
  # 接口级别限流配置
  rules:
    # 票券购买接口限流
    ticket-purchase:
      capacity: 50
      rate: 5.0
      warmup-tokens: 25
    
    # 票券查询接口限流
    ticket-query:
      capacity: 200
      rate: 20.0
      warmup-tokens: 100
    
    # 用户登录接口限流
    user-login:
      capacity: 30
      rate: 3.0
      warmup-tokens: 15
    
    # 订单查询接口限流
    order-query:
      capacity: 150
      rate: 15.0
      warmup-tokens: 75

# Redis配置（令牌桶限流依赖Redis）
spring:
  redis:
    host: localhost
    port: 6379
    database: 0
    timeout: 2000ms
    lettuce:
      pool:
        max-active: 8
        max-wait: -1ms
        max-idle: 8
        min-idle: 0

# 日志配置
logging:
  level:
    cn.monitor4all.miaoshaservice.service.impl.DistributedTokenBucketServiceImpl: DEBUG
    cn.monitor4all.miaoshaservice.aspect.DistributedTokenBucketLimitAspect: DEBUG
    cn.monitor4all.miaoshaservice.controller.DistributedTokenBucketDemoController: INFO
